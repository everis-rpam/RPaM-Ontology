@prefix :       <https://joinup.ec.europa.eu/collection/rpam/1.1.0/ontology#> .
@prefix owl:    <http://www.w3.org/2002/07/owl#> .
@prefix rdf:    <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix ubl:    <http://docs.oasis-open.org/ubl#> .
@prefix xml:    <http://www.w3.org/XML/1998/namespace> .
@prefix xsd:    <http://www.w3.org/2001/XMLSchema#> .
@prefix ccev:   <https://joinup.ec.europa.eu/collection/semic/ccev/2.0.3/ontology#> .
@prefix ccts:   <http://www.unece.org/cefact#> .
@prefix rdfs:   <http://www.w3.org/2000/01/rdf-schema#> .
@prefix skos:   <http://www.w3.org/2004/02/skos/core#> .
@prefix foaf:   <http://xmlns.com/foaf/0.1/> .
@prefix dct:    <http://purl.org/dc/elements/1.1/> .
@prefix adms:   <http://www.w3.org/ns/adms#> .
@prefix dcat:   <http://www.w3.org/ns/dcat#> .
@prefix pwr:    <http://data.europa.eu/RPaM/ontology/rd/powers#> .
@prefix stat:   <http://data.europa.eu/RPaM/ontology/rd/status#> .
@prefix uc:     <http://data.europa.eu/RPaM/ontology/rd/units#> .
@prefix ict:    <https://joinup.ec.europa.eu/collection/rpam/1.0.0/thesauri/irctype#> .
@prefix ctx:    <https://joinup.ec.europa.eu/collection/rpam/1.0.0/thesauri/constrainttaxonomy#> .
@prefix at:     <https://joinup.ec.europa.eu/collection/rpam/1.0.0/thesauri/administrationleveltype#> .
@prefix cc:     <https://joinup.ec.europa.eu/collection/rpam/1.0.0/thesauri/countrycode#> .
@prefix tu:     <https://eurostat/nuts/2016/> .
@prefix org:    <http://www.w3.org/ns/org#> .
@prefix ct: <https://joinup.ec.europa.eu/collection/rpam/1.0.0/thesauri/moremee#> .

<https://joinup.ec.europa.eu/collection/rpam/1.1.0/ontology#> rdf:type owl:Ontology ;
                                        owl:versionIRI <https://joinup.ec.europa.eu/collection/rpam/1.1.0/ontology.ttl> ;
                                        dct:description "A Data Set with one mandates conformat to the RPaM Ontology specification, supplied from an eMandate Registry in response to the request of a Service Provider (SP)."@en ,
                                                        "BEWARE that this Ontology is an ongoing development"@en ;
                                        dct:title "Example of an eMandateResponse document instance."@en ;
                                        dct:publisher "European Commission, ISA2 Programme"@en ;
                                        dct:creator "everis, Spain, S.L.U"@en ;
                                        dcat:distribution [
                                                skos:note "This file contains an instance of eMandate Request used by a Service Provider (SP) to request data on a user who is a mandatee trying to access one SP Service."@en ;
                                                dcat:accessURL <https://github.com/everis-rpam> ;
                                                skos:note "The URL GitHub Repository to download this file."@en ;
                                                dcat:downloadURL <https://github.com/everis-rpam/RPaM-Ontology/blob/v1.1.0/07-Testing/examples/eMandateResponse-example-1.ttl>
                                        ] ;
                                        skos:note "This eMandate Response should pass the validation tests, provided it is executed before 2019-12-12."@en ,
                                        		  " See the constraints specified herein and the mandate lifespan."@en .

#### Root elements of the Response

#### The Request individual
:res-1 a :eMandateResponse .

#### The root Response elements (data about the Response) ###############################################################

#### The Response document unique identifier. Issued by one of the RPaM authorised stakeholders (REA could stands for "Registro Español de Apoderamientos".)
:res-1 :id [:identifierValue "594651a8-d0e5-4684-ae6e-87358aa5d962"; :schemeID "UUID" ; :schemeAgencyID "ES-REA"] .
#### The date and time of issuance of this instance of Response. Normally stamped by the issuer System. 
:res-1 :issueDateTime  "2019-12-12T12:04:59"^^xsd:dateTime .
#### The current version of the content of this document. Additional Information: Beware that this identifies the "content" of the document, 
#### meaning that any subsequent modification of this document will have to change this version number and indicate which was the previous one 
#### (thus making possible to "chain" all the existing versions of the document). Notice also that in this Request instance no mention to a 
#### previous Request is made, as this is the first version and does not modifies a previous existing Request.
:res-1 :versionID [:identifierValue "1.0.0"; :schemeID "RPaM-VERSION-PATTERN" ; :schemeAgencyID "RPaM"] .
#### No customizationID is provided, as the user does not use it in any particular way, but as commonly used by the RPaM community.
#### No profileID is provided, as this Request is using the RPaM standard model, not an Application Profile.
:res-1 :profileExecutionID [:identifierValue "T-UC01-S01"; :schemeID "RPaM-PROFILE-PATTERN" ; :schemeAgencyID "RPaM"] .
:res-1 skos:note "In this Response, the eMandate Registry provides one single mandate with the empowerement of the person identified as the cross-border user. "@en ,
				 "Any other data about this or other persons originally in the same mandate have been pruned-off, as considered irrelevant for the eAuthorisation and for data protection and privacy respect."@en .
#### The version of the RPaM specification upon which this document instance is based on.
:res-1 :RPaMVersionID [:identifierValue "1.1.0"; :schemeID "RPaM-VERSION-PATTERN" ; :schemeAgencyID "RPaM"] .
#### Link to the Request document: two data are necessary to identify any document completely, the document id and the document content version id
:res-1 :requestID [:identifierValue "f5a1c342-f07f-4825-a844-64b310f220c1"; :schemeID "UUID" ; :schemeAgencyID "FR-FIN"] .
:res-1 :requestVersionID [:identifierValue "1.0.0"; :schemeID "RPaM-VERSION-PATTERN" ; :schemeAgencyID "RPaM"] .
#### It is also recommended to add the date and time when the Request was issued
:res-1 :requestDateTime "2019-12-12T12:03:21"^^xsd:dateTime .

#### The objects associated to the Response ###########################################################################

#### Association of the issuer to the Response
:res-1 :issuer :sys .
#### Information about the issuer of the Request
:sys a :System .
#### The identifier assigned by a future (non-yet-existent) European Registry of Registries to this "national authority system".
:sys :id [:identifierValue "http://datos.gob.es/rea/rpam#na07-sys1024"; :schemeID "RoR-NA-ID" ; :schemeAgencyID "EU-RoR"] .
#### An x509 Base64-coded certificate could also be used to identify the system.
:sys :id [:identifierValue "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" ;
		  :schemeID "x509" ; :schemeAgencyID "RPaM"].

#### Association of the mandate to the Response		  
#### The data used herein is taken from this mandate dataset: 
#### https://github.com/everis-rpam/RPaM-Ontology/blob/v1.1.0/07-Testing/examples/Mandates-Dataset-example-1.ttl
:res-1 :requests :VincencMandate-1 .
#### The mandate with the data about the power, mandator and mandatee
:VincencMandate-1 a :Mandate ;
		:mandator :Vicenc ;
		:empowerment :pwr ;
		#### The mandate is "alive", it has not been struck-off from the register. This should imply that the powers inside the mandate are also active.
		#### The current RPaM model of Mandate imposes the following rules (an EU-RPaM-AP proposal could simplify these rules):
		###### 1. A mandate that has been struck off in the eMandate Registry MUST not be returned in Response to a Request. 
		###### 2. The eMandate Registry MUST ensure that, in its system, when a mandate is struck-off each power defined therein assigned to one ore more mandatees change its status to `:STRUCK-OFF-MANDATE` (see the the taxonomy of [power statuses](https://github.com/everis-rpam/RPaM-Ontology/blob/v1.1.0/03-Syntax_Bindings/OWL-DL-TTL/rpam/thesauri/EU_Power_Status_Taxonomy.ttl)).
		###### 3. Conversely, when each power of a mandate contains mandatee constraints of the type `ValidityPeriod` where the end date or duration measure is greater than the current date and time the mandate should be automatically struck-off from the register.
		:lifeSpan [:startDateTime "2017-05-12T02:03:10"^^xsd:dateTime ] .

#### Vicenc, the mandator is a natural person
:Vicenc a :Mandator, foaf:Person ;
		##### Notice that Vicenç is a Spanish citizen. His ID card was issued by the Spanish Ministry of Interior.
		:id [:identifierValue "77812129V"; :schemeID "ES-NIF" ; :schemeAgencyID "ES-INTERIOR"]
		:givenName "Vicenç" ; 
		:familyName "Pons i Torra" .

#### Thomas, the mandatee is a natural person
:Thomas a :Mandatee, foaf:Person ;
		##### Notice that Thomas is a non-Spanish citizen that is resident in Spain. 
		##### Thomas is using a Spanish ID card issued by the Spanish Ministry of Interior to foreigners.
		:id [:identifierValue "23141243X"; :schemeID "ES-NIE" ; :schemeAgencyID "ES-INTERIOR"] ;
		:givenName "Thomas" ; :familyName "Shutterfield" .
#### Data about the empowerment: triple rpam:Mandate rpam:empowerment rpam:Power 
:VincencMandate-1 :empowerment :pwr .
:pwr a :Power ;
		##### The type of power neeeded to be authorised in the SP-Service. 
		##### This power is defined in the EU Power Taxnomy. See file in GitHub:  
		##### https://github.com/everis-rpam/RPaM-Ontology/blob/v1.1.0/03-Syntax_Bindings/OWL-DL-TTL/rpam/thesauri/EU_Power_Taxonomy.ttl
		##### Notice that the type of power in this Response matches the one specified in the Request.
		:powerType pwr:STARTING_BUSINESS ;
		##### The status of the power: only "confirmed" empowerments can be used. See the statuses of the powers in the taxonomy:
		##### https://github.com/everis-rpam/RPaM-Ontology/blob/v1.1.0/03-Syntax_Bindings/OWL-DL-TTL/rpam/thesauri/EU_Power_Status_Taxonomy.ttl
		stat::CONFIRMED ;
		##### The delegation level is 1, hence the SP could need to request the mandator's mandatee.
		:delegationLevel 1 ;
		##### The empowered mandatee. See the conceptual data model for a visual representation.
		:mandatee :Thomas ;
		#### Constraints about the use of the power by the mandator may be relevant: it could be necessary to compare this 
        #### constraints with the ones applied by the mandatee and validate any possible inconsistency.
		:mandatorConstraint :Morcp05, :Morcp06, :Morcp07, :Morcp08 ;
        :mandateeConstraint :Meecp05, :Meecp06, :Meecp07, :Meecp08 ;


#### The constraints about the use of this power that, according to the eMandate Registy, apply to the mandator and the mandatee. 

#### Maximum financial threshold for the mandator (remember that this mandator obtained this power as the mandatee of another mandator).
:Morcp05 a 	ccev:CriterionProperty ;
    		ccev:type ct:FinancialCeil ; 
			ccev:constraint [ccev:datumAmount [ccts:amountValue "400000.00"^^xsd:decimal ; ccts:currencyID "EUR"]] .
#### Maximum financial threshold for the mandatee. Noticie that in this case the constraints are coherent as 400K > 170K.
:Meecp05 a	ccev:CriterionProperty ;
    		ccev:type ct:FinancialCeil ; 			
			ccev:constraint [ccev:datumAmount [ccts:amountValue "170000.00"^^xsd:decimal ; ccts:currencyID "EUR"]] .
#### Territorial scope where this mandator can use this power. Notice that the second constraint BENELUX is unnecessary, as all
#### the countries in the Benelux are also in the European Economic Area (EEA).
:Morcp06 a   ccev:CriterionProperty ;
			ccev:type ct:TerritorialUnitScope ;
			ccev:constraint [ccev:datumCode  [ccts:codeValue tu:EEA; ccts:schemeID "NUTS2016"; ccts:schemeAgencyID "EUROSTAT"],
											[ccts:codeValue tu:BENELUX; ccts:schemeID "NUTS2016"; ccts:schemeAgencyID "EUROSTAT"]] .
#### Territorial scope where this mandatee can use this power. Notice that this constraint is consistent with the ones for the mandator, 
#### the Benelux is inside the EEA. However, the SP SHOULD reject the authorisation, as France is not part of the Benelux.
:Meecp06 a  ccev:CriterionProperty ;
			ccev:type ct:TerritorialUnitScope ;
			ccev:constraint [ccev:datumCode  [ccts:codeValue tu:EU; ccts:schemeID "NUTS2016"; ccts:schemeAgencyID "EUROSTAT"]] .
#### The mandator MUST NOT use this power beyond the 12th December 2019,
:Morcp07 a   ccev:CriterionProperty ;
			ccev:type ct:ValidityPeriod ;
			ccev:constraint [ccev:datumPeriod [ ubl:endDate "2019-12-12"^^xsd:date ]] .
#### The mandatee MUST NOT use this power beyond the 6th December 2019. This is coherent with the mandator constraint, as 2019-12-12 > 2019-12-06.
:Meecp07 a   ccev:CriterionProperty ;
			ccev:type ct:ValidityPeriod ;
			ccev:constraint [ccev:datumPeriod [ ubl:endDate "2019-12-06"^^xsd:date ]] .
#### The mandatee will not be able to use this power again, only this time.
:Meecp08 a   ccev:CriterionProperty ;
			ccev:type ct:OneSingleUse ;
			ccev:constraint [ccev:datumIndicator "true"^^xsd:boolean] .

#### No document reference is needed in this example
#### No constraints are applied at the Request level. See documentation and rules on the different levels of constraints.




